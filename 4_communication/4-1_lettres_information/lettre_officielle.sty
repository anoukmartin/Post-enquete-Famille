% lettre_officielle.sty
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{lettre_officielle}[2025/10/09 Style pour lettres officielles]

% Marges et mise en page
\RequirePackage[a4paper,top=3cm,bottom=3cm,left=3cm,right=3cm]{geometry}

% Police sobre
\RequirePackage{times}

% en français 
\RequirePackage[french]{babel}

% Espacement
\RequirePackage{setspace}
\setstretch{1.2}

% Gestion des alinéas
\setlength{\parindent}{2.5em}   % taille de l'alinéa
\setlength{\parskip}{0.5em}     % espace vertical entre paragraphes

% Packages utiles
\usepackage{graphicx}
\usepackage{fancyhdr}
\usepackage{lastpage}

\usepackage{tcolorbox}
\usepackage{changepage}  % pour adjustwidth
\usepackage{titlesec}    % pour gérer espacement des titres
\usepackage[absolute,overlay]{textpos}
\setlength{\TPHorizModule}{1mm}
\setlength{\TPVertModule}{1mm}

% Titres serrés
\titlespacing*{\section}{0pt}{0.5\baselineskip}{0.3\baselineskip}
\titlespacing*{\subsection}{0pt}{0.4\baselineskip}{0.2\baselineskip}

\usepackage{fancyhdr}
\pagestyle{fancy}

% Supprimer les traits par défaut
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}

% Logo(s) en haut à gauche
\fancypagestyle{plain}{
  \fancyhf{}
  \renewcommand{\headrulewidth}{0pt}
  \fancyhead[L]{\includegraphics[height=2cm]{3_logo.png}}
}

\setlength{\headheight}{50pt}
\setlength{\headsep}{20pt}


% Date (par défaut la date du jour)
\newcommand{\datelettre}[1][\today]{
  \begin{flushright}
  A Paris, le #1,
  \end{flushright}
  \vspace{1em}
}

% Signature alignée à droite
\newcommand{\signature}[1]{
  \vspace{0cm}
  \small
  \begin{flushright}
  #1
  \end{flushright}
  \normalsize
}

\newcommand{\destinataire}[1]{%
  \clearpage
  \thispagestyle{empty}
  \noindent
  \begin{textblock*}{80mm}(110mm,150mm)
  \large
  \noindent
  #1
  \normalsize
  \end{textblock*}
  
}

% -----------------------------
% Commande pour notice compacte
% -----------------------------


\newenvironment{NoticeCompacte}{
  % Marges réduites
  \begin{adjustwidth}{-1cm}{-1cm}
  % Espacement vertical
  \setlength{\parskip}{0.2em}
  \setlength{\baselineskip}{11pt}
  % Footnotes compactes
  % Titres serrés
}{
  \end{adjustwidth}
}
\pagestyle{plain}